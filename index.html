<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íƒ€ì ì—°ìŠµìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ íƒ€ì ì‹¤ë ¥</title>
    <style>
        @font-face {
            font-family: 'NeoDunggeunmoPro-Regular';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/NeoDunggeunmoPro-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        * {
            font-family: 'NeoDunggeunmoPro-Regular';
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            background-color: #000; 
            background-image: url('cyber1.jpg'); 
            background-size: cover; 
            background-position: center; 
            color: #fff; 
        }

        #gameArea {
            position: relative;
            width: 80%;
            height: 50vh; 
            border: 2px solid #fff; 
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.5); 
            margin-bottom: 20px; 
            margin-top: 20px;
            border-radius: 10px;
        }

        .fallingWord {
            position: absolute;
            font-size: 2em;
            color: #fff; 
            white-space: nowrap;
        }

        #input {
            font-size: 1.5em;
            padding: 10px;
            width: 300px;
            margin-top: 10px; 
            margin-bottom: 20px; 
            background-color: rgba(255, 255, 255, 0.8);
            color: #000; 
        }

        #score, #timer {
            font-size: 1.5em;
            margin-top: 10px;
            position: absolute; 
            right: 20px;
            background-color: #000; 
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #fff; 
            color: #fff; 
        }

        #score {
            top: 20px; 
        }

        #timer {
            top: 70px; 
        }

        #startBtn, #restartBtn {
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 10px;
            border: none;
            background-color: #fff; 
            color: #000; 
            border-radius: 5px;
        }

        #difficulty {
            margin-top: 20px;
        }

        #nicknameContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }

        #nickname {
            font-size: 1.5em;
            padding: 10px;
            margin-bottom: 10px;
            background-color: rgba(255, 255, 255, 0.8); 
            color: #000; 
        }

        #restartBtn {
            display: none; 
            margin-top: 10px;
        }

        #result {
            display: none;
            font-size: 2em; 
            text-align: center;
            margin-top: 20px;
            background-color: rgba(255, 255, 255, 0.9); 
            border: 2px solid #fff; 
            padding: 20px;
            border-radius: 10px;
            color: #000;
        }

        .spacing {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1 style="font-size: 3.5rem;">íƒ€ì ì—°ìŠµìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ íƒ€ì ì‹¤ë ¥</h1>
    <div id="nicknameContainer">
        <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”">
        <div id="difficulty">
            ë‚œì´ë„ ì„ íƒ: 
            <select id="difficultySelect" style="padding-bottom:5px;">
                <option value="beginner">ì´ˆê¸‰</option>
                <option value="intermediate">ì¤‘ê¸‰</option>
                <option value="advanced">ìƒê¸‰</option>
            </select>
        </div>
        <button id="startBtn">ê²Œì„ ì‹œì‘</button>
    </div>
    <div id="gameArea" class="spacing"></div>
    <input type="text" id="input" placeholder="ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”" style="display: none;">
    
    <div id="score">ì ìˆ˜: 0</div>
    <div id="timer" style="color: orangered;">ë‚¨ì€ ì‹œê°„: 30ì´ˆ</div>
    
    <div id="result"></div>
    <span id="restartBtn">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</span>

    <audio id="bgMusic" src="aespa.mp3" preload="auto"></audio> 

    <script>
        const words = [
            "ì‚¬ê³¼", "ë°”ë‚˜ë‚˜", "ì²´ë¦¬", "ë”¸ê¸°", "í¬ë„", 
            "í‚¤ìœ„", "ì˜¤ë Œì§€", "ë°°", "ë§ê³ ", "ë³µìˆ­ì•„", 
            "íŒŒì¸ì• í”Œ", "ë ˆëª¬", "ê°œ", "ê³ ì–‘ì´", "ìƒˆ", 
            "ì½”ë¼ë¦¬", "í† ë¼", "ì£¼í™©", "íŒŒë‘", "ê²€ì •", 
            "í°ìƒ‰", "ì´ˆë¡", "ë…¸ë‘", "í•‘í¬", "íšŒìƒ‰", "í–„ìŠ¤í„°", "ë§ê³ ìŠ¤í‹´", "ì–¼ë£©ë§", "ë„ˆêµ¬ë¦¬", 
            "ë³‘ì•„ë¦¬", "ë‹­", "ë³´ë¼", "ìˆ˜ë°•", "ë¼ì„"
        ];

        let score = 0;
        let timeLeft = 30; 
        let gameInterval;
        let dropInterval;
        let fallingSpeed = 1; 
        const gameArea = document.getElementById('gameArea');
        const inputElement = document.getElementById('input');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');
        const startBtn = document.getElementById('startBtn');
        const difficultySelect = document.getElementById('difficultySelect');
        const restartBtn = document.getElementById('restartBtn');
        const nicknameInput = document.getElementById('nickname');
        const resultElement = document.getElementById('result');
        const bgMusic = document.getElementById('bgMusic');

        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', resetGame);
        inputElement.addEventListener('keydown', handleInput);

        function startGame() {
            if (nicknameInput.value.trim() === "") {
                alert("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”!");
                return;
            }

            score = 0;
            timeLeft = 30; 
            scoreElement.textContent = `ì ìˆ˜: ${score}`;
            timerElement.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
            inputElement.value = '';
            inputElement.style.display = 'block'; 
            inputElement.focus();
            clearInterval(gameInterval);
            clearInterval(dropInterval);
            setDifficulty();
            gameInterval = setInterval(updateTimer, 1000); 
            dropInterval = setInterval(createFallingWord, 1000 / fallingSpeed); 
            restartBtn.style.display = 'none'; 
            resultElement.style.display = 'none'; 
            bgMusic.play(); 
        }

        function setDifficulty() {
            const difficulty = difficultySelect.value;
            if (difficulty === "beginner") {
                fallingSpeed = 1; 
            } else if (difficulty === "intermediate") {
                fallingSpeed = 1.4; 
            } else if (difficulty === "advanced") {
                fallingSpeed = 1.8;
            }
        }

        function updateTimer() {
            timeLeft--;
            timerElement.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
            if (timeLeft <= 0) {
                clearInterval(gameInterval);
                clearInterval(dropInterval);
                showResult();
                bgMusic.pause(); 
                bgMusic.currentTime = 0; 
            }
        }

        function createFallingWord() {
            const wordElement = document.createElement('div');
            const randomWord = words[Math.floor(Math.random() * words.length)];
            wordElement.textContent = randomWord;
            wordElement.className = 'fallingWord';

            let overlap;
            let leftPosition;

            // ê²¹ì¹˜ì§€ ì•ŠëŠ” ìœ„ì¹˜ë¥¼ ì°¾ì„ ë•Œê¹Œì§€ ë°˜ë³µ
            do {
                overlap = false;
                leftPosition = Math.random() * (gameArea.clientWidth - 100) + 'px'; // ëœë¤ x ìœ„ì¹˜ ì„¤ì •
                wordElement.style.left = leftPosition; // ì„¤ì •í•œ ìœ„ì¹˜ë¡œ ë‹¨ì–´ ìœ„ì¹˜ ë³€ê²½

                // í˜„ì¬ ê²Œì„ ì˜ì—­ ë‚´ì˜ ëª¨ë“  ë‹¨ì–´ì™€ ê²¹ì¹˜ëŠ”ì§€ í™•ì¸
                const existingWords = gameArea.getElementsByClassName('fallingWord');
                for (let existingWord of existingWords) {
                    const existingRect = existingWord.getBoundingClientRect();
                    wordElement.style.position = 'absolute'; 
                    const newRect = wordElement.getBoundingClientRect();

                    if (newRect.left < existingRect.right &&
                        newRect.right > existingRect.left &&
                        newRect.top < existingRect.bottom &&
                        newRect.bottom > existingRect.top) {
                        overlap = true; // ê²¹ì¹¨ì´ ë°œìƒí•˜ë©´ ë‹¤ì‹œ ìœ„ì¹˜ë¥¼ ì°¾ìŒ
                    }
                }
            } while (overlap); // ê²¹ì¹¨ì´ ì—†ì„ ë•Œê¹Œì§€ ë°˜ë³µ

            gameArea.appendChild(wordElement);

            let position = 0;
            const fallInterval = setInterval(() => {
                if (position >= gameArea.clientHeight - 50) {
                    clearInterval(fallInterval);
                    gameArea.removeChild(wordElement);
                } else {
                    position += fallingSpeed * 5; 
                    wordElement.style.top = position + 'px';
                }
            }, 1000 / fallingSpeed);

            // ì—”í„° í‚¤ë¥¼ ëˆŒë €ì„ ë•Œ ë‹¨ì–´ë¥¼ ì‚­ì œí•˜ê³  ì ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥
            wordElement.addEventListener('click', () => {
                if (inputElement.value === randomWord) {
                    score += randomWord.length; 
                    scoreElement.textContent = `ì ìˆ˜: ${score}`;
                    gameArea.removeChild(wordElement);
                    inputElement.value = '';
                }
            });
        }

        function handleInput(event) {
            if (event.key === 'Enter') {
                const currentWordElements = gameArea.getElementsByClassName('fallingWord');
                for (let wordElement of currentWordElements) {
                    if (wordElement.textContent === inputElement.value) {
                        score += inputElement.value.length; // ì ìˆ˜ ê³„ì‚°
                        scoreElement.textContent = `ì ìˆ˜: ${score}`;
                        gameArea.removeChild(wordElement); // ë§ì¶˜ ë‹¨ì–´ ì‚­ì œ
                        inputElement.value = ''; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
                        break; // ì²« ë²ˆì§¸ ì¼ì¹˜í•˜ëŠ” ë‹¨ì–´ë§Œ ì‚­ì œ
                    }
                }
            }
        }

        function showResult() {
            resultElement.style.display = 'block';
            resultElement.textContent = `${nicknameInput.value}ë‹˜ì˜ ìµœì¢… ì ìˆ˜ëŠ” ${score}ì ì…ë‹ˆë‹¤!`;
            restartBtn.style.display = 'block'; 
        }

        function resetGame() {
            score = 0;
            timeLeft = 30; 
            scoreElement.textContent = `ì ìˆ˜: ${score}`;
            timerElement.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
            inputElement.value = '';
            gameArea.innerHTML = '';
            inputElement.style.display = 'none'; 
            resultElement.style.display = 'none'; 
            restartBtn.style.display = 'none'; 
            bgMusic.pause(); 
            bgMusic.currentTime = 0; 
        }
    </script>
</body>
</html>
